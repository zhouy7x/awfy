{"version":3,"sources":["../../src/utils/json.js"],"names":["mergeAdacentJSONTextNodes","node","includeFunctionBodies","visitedNodes","undefined","Set","has","add","Array","isArray","arr","length","concatString","i","child","push","key","value","toString"],"mappings":";;;;;QAcgBA,yB,GAAAA,yB;;;AADhB;AAbA;;;;;;;;;AAcO,SAASA,yBAAT,CAAmCC,IAAnC,EAA+CC,qBAA/C,EAA+EC,YAA/E,EAAyG;AAC9G,MAAIA,iBAAiBC,SAArB,EAAgC;AAC9BD,mBAAe,IAAIE,GAAJ,EAAf;AACD;AACD,MAAIF,aAAaG,GAAb,CAAiBL,IAAjB,CAAJ,EAA4B;AAC1B,WAAO,YAAP;AACD;AACDE,eAAaI,GAAb,CAAiBN,IAAjB;;AAEA;AACA,MAAIO,MAAMC,OAAN,CAAcR,IAAd,CAAJ,EAAyB;AACvB;AACA,QAAIS,MAAM,EAAV;AACA,QAAIC,SAASV,KAAKU,MAAlB;AACA,QAAIC,eAAe,IAAnB;AACA,QAAIC,IAAI,CAAC,CAAT;AACA,WAAOA,MAAMF,MAAb,EAAqB;AACnB,UAAIG,QAAQb,KAAKY,CAAL,CAAZ;AACA,UAAI,OAAOC,KAAP,KAAiB,QAAjB,IAA6B,OAAOA,KAAP,KAAiB,QAAlD,EAA4D;AAC1D,YAAIF,iBAAiB,IAArB,EAA2B;AACzBA,0BAAgBE,KAAhB;AACD,SAFD,MAEO;AACLF,yBAAeE,KAAf;AACD;AACF,OAND,MAMO,IAAI,OAAOA,KAAP,KAAiB,QAAjB,IAA6BA,UAAU,IAA3C,EAAiD;AACtD,YAAIF,iBAAiB,IAArB,EAA2B;AACzBF,cAAIK,IAAJ,CAASH,YAAT;AACAA,yBAAe,IAAf;AACD;AACDF,YAAIK,IAAJ,CAASf,0BAA0Bc,KAA1B,EAAiCZ,qBAAjC,EAAwDC,YAAxD,CAAT;AACD;AACF;AACD,QAAIS,iBAAiB,IAArB,EAA2B;AACzBF,UAAIK,IAAJ,CAASH,YAAT;AACD;AACD,WAAOF,GAAP;AACD,GA1BD,MA0BO;AACL,SAAK,IAAIM,GAAT,IAAgBf,IAAhB,EAAsB;AACpB,UAAIgB,QAAQhB,KAAKe,GAAL,CAAZ;AACA,UAAI,OAAOC,KAAP,KAAiB,UAArB,EAAiC;AAC/B,YAAI,CAACf,qBAAL,EAA4B;AAC1BD,eAAKe,GAAL,IAAYC,MAAMC,QAAN,EAAZ;AACD,SAFD,MAEO;AACL,iBAAOjB,KAAKe,GAAL,CAAP;AACD;AACF,OAND,MAMO,IAAI,OAAOC,KAAP,KAAiB,QAAjB,IAA6BA,UAAU,IAA3C,EAAiD;AACtDhB,aAAKe,GAAL,IAAYhB,0BAA4BiB,KAA5B,EAAgDf,qBAAhD,EAAuEC,YAAvE,CAAZ;AACD;AACF;AACF;AACD,SAAOF,IAAP;AACD","file":"json.js","sourcesContent":["/**\n * Copyright (c) 2017-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n/* @flow */\ntype JSONValue = Array<JSONValue> | string | number | JSON;\ntype JSON = { [key: string]: JSONValue };\n\n// this will mutate the original JSON object\nexport function mergeAdacentJSONTextNodes(node: JSON, includeFunctionBodies: boolean, visitedNodes?: Set<JSON>) {\n  if (visitedNodes === undefined) {\n    visitedNodes = new Set();\n  }\n  if (visitedNodes.has(node)) {\n    return \"[Circular]\";\n  }\n  visitedNodes.add(node);\n\n  // we merge adjacent text nodes\n  if (Array.isArray(node)) {\n    // we create a new array rather than mutating the original\n    let arr = [];\n    let length = node.length;\n    let concatString = null;\n    let i = -1;\n    while (i++ < length) {\n      let child = node[i];\n      if (typeof child === \"string\" || typeof child === \"number\") {\n        if (concatString !== null) {\n          concatString += child;\n        } else {\n          concatString = child;\n        }\n      } else if (typeof child === \"object\" && child !== null) {\n        if (concatString !== null) {\n          arr.push(concatString);\n          concatString = null;\n        }\n        arr.push(mergeAdacentJSONTextNodes(child, includeFunctionBodies, visitedNodes));\n      }\n    }\n    if (concatString !== null) {\n      arr.push(concatString);\n    }\n    return arr;\n  } else {\n    for (let key in node) {\n      let value = node[key];\n      if (typeof value === \"function\") {\n        if (!includeFunctionBodies) {\n          node[key] = value.toString();\n        } else {\n          delete node[key];\n        }\n      } else if (typeof value === \"object\" && value !== null) {\n        node[key] = mergeAdacentJSONTextNodes(((value: any): JSON), includeFunctionBodies, visitedNodes);\n      }\n    }\n  }\n  return node;\n}\n"]}