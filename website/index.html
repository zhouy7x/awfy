<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
 <meta http-equiv="content-type" content="text/html; charset=UTF-8">
 <meta http-equiv="content-language" content="en">
 <title>ARE WE FAST YET?</title>
 <link rel="stylesheet" title="Default Stylesheet" type="text/css" href="style.css">
 <link rel="shortcut icon" href="http://www.arewefastyet.com/awfy_favicon.png">
 <script type="text/javascript" src="jquery/jquery-1.8.3.min.js"></script>
 <script type="text/javascript" src="jquery/jquery.ba-hashchange.min.js"></script>
 <script type="text/javascript" src="flot/jquery.flot.js"></script>
 <script type="text/javascript" src="flot/jquery.flot.selection.js"></script>
 <script type="text/javascript" src="data.php?file=master.js"></script>
 <script type="text/javascript" src="awfy.js"></script>
 <script type="text/javascript" src="frontpage.js"></script>
 <script type="text/javascript" src="tooltip.js"></script>
 <style>
 #totop{ position:fixed; bottom:0; right:10px; cursor:pointer; }
 #buttonbox{ position:fixed; top:20px; right:10px }
 #commit-div{ position:fixed; top:60px; right:10px; text-align: left; height: 80%; overflow-y: auto;}
 .benchmark-record {padding: 8px 0 0 16px;}
 </style>
</head>
<body>
<!--[if IE 6]><body class="ie ie6"><![endif]-->
<!--[if IE 7]><body class="ie ie7"><![endif]-->
<!--[if IE 8]><body class="ie ie8"><![endif]-->
<!--[if IE 9]><body class="ie ie9"><![endif]-->
<!--[if gt IE 9]><body class="ie"><![endif]-->
<!--[if !IE ]><!-->
<body>
<!--<![endif]-->
  <script type="text/javascript">
    $(document).ready(function () {
	AWFY.startup();
    });

    function highlightPoints() {
        var threshold = parseInt($("#hlvalue").val());
        if (isNaN(threshold)) {
            return;
        } else {
            threshold = threshold.toFixed(2) / 100;
        }

        $(".graph").each(function() {
            //console.log(this);
            var display = $(this).data("awfy-display");
            if (!display || !display.plot) {
                return;
            }
            var plot = display.plot;

            // unhighlight previous
            plot.unhighlight();

            var graph = display.graph;
            var series = graph.lines;
            for (var y = 0; y < series.length; y++) {
                line = series[y].data;
                var cur = null, pre = null;
                for (var x = 0; x < line.length; x++) {
                    if (line[x][1] != null) {
                        pre = cur;
                        cur = line[x][1];
                    } else {
                        continue;
                    }
                    if (pre == null || cur == null) {
                        continue;
                    }
                    if (Math.abs(cur - pre) / pre.toFixed(2) > threshold) {
                        plot.highlight(y, x);
                    }
                }
            }
        });
    }


    function highlightTest(display, id) {
      var plot = display.plot;

      // unhighlight previous
      plot.unhighlight();

      var graph = display.graph;
      var info = graph.info;

      for (var y = 0; y < info.length; y++) {
        var modeid = info[y].modeid;
        if (!AWFYMaster.modes[modeid] || !AWFYMaster.modes[modeid])
          continue;

        var line = info[y].data;
        for (var x = 0; x < line.length; x++) {
          var dot = line[x];
          if (dot && ((typeof(dot[1]) === "string" && ~dot[1].indexOf(id))/* || (typeof(dot[2]) === "string" && ~dot[2].indexOf(id))*/)) {
            plot.highlight(y, x);
          }
        }
      }
    }

    function searchCommit() {
      var id = $("#commit-id").val().trim();  // '0898bf4835195105d888cf34483e767b8b66fad7'
      var resdiv = $("#query-results");

      resdiv.empty();
      if (id.length < 3)
        return;

    AWFY.query(AWFY.machineId, AWFY.view, AWFY.suiteName ? AWFYMaster.suites[AWFY.suiteName].id : "-", id, AWFY.subtest || "", function(data) {
      var records = JSON.parse(data);
      //console.log(records);

      if (records.length === 0) {
        resdiv.append($("<div>No benchmark records</div>"));
        return;
      }

      var date = new Date(parseInt(records[0].stamp) * 1000);
      var tested = date.toLocaleString();

      date.setHours(0);
      date.setMinutes(0);
      date.setSeconds(0);
      var s = (date.getTime() / 1000) | 0;

      date.setDate(date.getDate() + 1);
      var e = (date.getTime() / 1000) | 0;

      $(".graph").each(function() {
        var display = $(this).data("awfy-display");
        if (!display) {
          return;
        }
        AWFY.requestZoom(display, 'raw', s, e, highlightTest.bind({}, display, id));
      });

      resdiv.append($("<div class='benchmark-record'>" + "<strong>tested: </strong>" + tested + "</div>"));
      for (var i = 0; i < records.length; i++) {
        var r = records[i];
        var m = AWFYMaster.modes[r.mode_id];
        if (!m || !m.used)
          continue;

        var name = r.name ? "<strong>name: </strong>" + r.name + "<br>" : "";
        var mode = "<strong>mode: </strong>" + m.name + "<br>";
        var score = "<strong>score: </strong>" + r.score;
        var item = $("<div class='benchmark-record' style='color:" + m.color + "'>" + name + mode + score + "</div>");
        resdiv.append(item);
      }
    });
  }

  function query_past(days) {
    var date = new Date();
    var start, end = (date.getTime() / 1000) | 0;
    date.setDate(date.getDate() - days);
    start = (date.getTime() / 1000) | 0;

    $(".graph").each(function() {
      var display = $(this).data("awfy-display");
      if (!display) {
          return;
      }
      AWFY.requestZoom(display, 'raw', start, end);
    });
  }

  </script>
    <div id="totop" onclick="window.scrollTo(0,0);" ><h2>Back To Top</h2></div>
 <div class="graph-row">
  <div id="message"></div>
  <div id="buttonbox">
    <input type="button" value="LastWeek" onclick="query_past(8)" />
    <input type="button" value="LastMonth" onclick="query_past(32)" style="margin-right: 32px"/>
    Î”<input id="hlvalue" type="text" size="4" />%
    <input id="hlbutton" type="button" value="highlight" onclick="highlightPoints()" />
  </div>
  <div id="commit-div">
    Commit Id: <input id="commit-id" type="text" size="36" />
    <input type="button" value="search" onclick="searchCommit()" />
    <div id="query-results">
    </div>
  </div>
  <div id="navcontainer">
    <ul id="legend"></ul>
    <br><br>
    <ul class="menu">
      <li id="machinehook"><a href="#" id="machinedrop">Machines</a> &#187;
        <ul id="machinelist"></ul>
      </li>
      <li id="breakdownhook"><a href="#" id="bkdrop">Breakdown</a> &#187;
        <ul id="breakdownlist"></ul>
      </li>
      <li><a href='#' id="aboutdrop">About</a> &#187;</li>
    </ul>
  </div>
  <div class="graph-container">
    <div id="kraken-label">kraken time</div>
    <div class="graph" id="kraken-graph"><h2>Loading...</h2></div>
  </div>
  <div class="graph-container">
    <div id="sunspider-label">sunspider time</div>
    <div class="graph" id="ss-graph"><h2>Loading...</h2></div>
  </div>
 </div>
 <br><br><br>
 <div>
  <div class="graph-row">
   <div class="graph-container">
     <div id="octane-label">octane2 score</div>
     <div class="graph" id="octane-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <!--div class="graph-container">
     <div id="octane1-label">octane1 score</div>
     <div class="graph" id="octane1-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <div class="graph-container">
     <div id="jr-perf-label">JerrySunspider Memory score</div>
     <div class="graph" id="JerrySunspiderMem-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <div class="graph-container">
     <div id="jr-mem-label">JerrySunspider Performance score</div>
     <div class="graph" id="JerrySunspiderPerf-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br-->
   <div class="graph-container">
     <div id="WebTooling-label">WebTooling score</div>
     <div class="graph" id="WebTooling-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <div class="graph-container">
     <div id="ARES6-label">ARES6 time</div>
     <div class="graph" id="ARES6-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <div class="graph-container">
     <div id="d8-label">d8 file Size</div>
     <div class="graph" id="d8-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <div class="graph-container">
     <div id="snapshot_blob-label">snapshot_blob.bin file Size</div>
     <div class="graph" id="snapshot_blob-graph"><h2>Loading...</h2></div>
   </div>
  </div>
  <br><br><br>
 </div>
 <div>
<!--
  <div class="graph-row">
   <div class="graph-container">
     <div id="VellamoSurfWaxBinder-label">VellamoSurfWaxBinder 3.1 score</div>
     <div class="graph" id="VellamoSurfWaxBinder-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <div class="graph-container">
     <div id="VellamoKruptein-label">VellamoKruptein 3.1 score</div>
     <div class="graph" id="VellamoKruptein-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <div class="graph-container">
     <div id="VellamoDeepCrossfader-label">VellamoDeepCrossfader 3.1 score</div>
     <div class="graph" id="VellamoDeepCrossfader-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <div class="graph-container">
     <div id="JetStreamShell-label">JetStreamShell 1.0 score</div>
     <div class="graph" id="JetStreamShell-graph"><h2>Loading...</h2></div>
   </div>
  </div>
  <br><br><br>
 </div>
 <div>
-->
  <div class="graph-row">
<!--
   <div class="graph-container">
     <div id="WebXPRTStock-label">WebXPRT 2013 stock Dashboard</div>
     <div class="graph" id="WebXPRTStock-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <div class="graph-container">
     <div id="WebXPRTStorage-label">WebXPRT 2013 Storage Notes</div>
     <div class="graph" id="WebXPRTStorage-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <div class="graph-container">
     <div id="WebXPRTStockLib-label">WebXPRT 2015 stocklibrary</div>
     <div class="graph" id="WebXPRTStockLib-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
-->
   <div class="graph-container">
     <div id="speedometer2-label">speedometer2 score</div> 
     <div class="graph" id="speedometer2-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <div class="graph-container">
     <div id="Unity3D-label">Unity3D score</div>
     <div class="graph" id="Unity3D-graph"><h2>Loading...</h2></div>
   </div>	
   <br><br><br>
  </div>
  <br><br><br>
 </div>

 <div>
  <!--div class="graph-row">
   <div class="graph-container">
     <div id="browsermark-label">browsermark 2.1 js score</div>
     <div class="graph" id="browsermark-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <div class="graph-container">
     <div id="browsermark1-label">browsermark 2.1 contentshell dom</div>
     <div class="graph" id="browsermark1-graph"><h2>Loading...</h2></div>
   </div>
   <br><br><br>
   <div class="graph-container">
     <div id="browsermark2-label">browsermark 2.1 contentshell scalable solution</div>
     <div class="graph" id="browsermark2-graph"><h2>Loading...</h2></div>
   </div>
  </div>
  <br><br><br-->
  <div class="graph-row">
   <div class="graph-container">
     <div id="robohornet-label">RoboHornet benchmark</div>
     <div class="graph" id="robohornet-graph"><h2>Loading...</h2></div>
   </div>
  </div>
  <br><br><br>
 </div>
 <div id="breakdown">
 </div>
 <div id="about">
  <h2>AreWeFastYet: tracking performance of popular JavaScript engines</h2>
  <strong>Basic usage:</strong>
  <ul>
   <li>The x-axis is the date we ran tests, and the y-axis is the score of the benchmark.</li>
   <li>The front page displays a hybrid of historical data, as well as the most recent samples.</li>
   <li>You can click on a datapoint to see a tooltip with more information.</li>
   <li>Tooltips will either give you the revision range used to condense a point, or the changelog that occurred in between two points.</li>
   <li>Tooltips can be dragged around, for easier comparison.</li>
   <li>Some benchmarks use time (lower is better), and some use points (higher is better). We orient all graphs so lower is better, visually.</li>
   <li>Use the "machine" menu to see different computers' benchmark results.</li>
   <li>Use the "Breakdown" menu to drill down into individual benchmarks.</li>
   <li>You can click and highlight any area of any graph to zoom in. It might pause to download data.</li>
   <li>You can unzoom by double-clicking inside a graph.</li>
   <li>A graph will refresh every 5 minutes if it is not zoomed in and has no attached tooltips.</li>
  </ul>
  <strong>FAQ:</strong>
  <ul>
   <li>
    <p>Who maintains this site?</p>
    <p>This site is maintained by Mozilla's JavaScript team.</p>
   </li>
   <li>
    <p>How does it work?</p>
    <p>AWFY is automated. Throughout the day, we checkout the latest source code to each available JavaScript engine, and compile it. Then we run it through some benchmark suites, and tally up the scores into a database. This data gets exported as JSON which can then be easily plotted.</p>
   </li>
   <li>
    <p>Why aren't Opera or IE available?</p>
    <p>AWFY currently runs standalone, command-line JavaScript shells - not the web browsers that embed them. Opera doesn't provide a standalone shell, and IE doesn't work on Mac or Linux (which is where we benchmark right now).</p>
   </li>
   <li>
    <p>What are the graphs?</p>
    <p>The top left-hand graph is Mozilla's Kraken benchmark. The top right-hand graph is Apple's SunSpider benchmark. The bottom graph is Google's V8 benchmark suite.</p>
   </li>
   <li>
    <p>What do the hover tips mean?</p>
    <p>"Source" is where we got the engine from. "Tested" is when we downloaded the engine, compiled, and tested it. "Rev" is the unique point in the engine's revision history we tested. If the datapoint represents a range, there may be multiple revs. These numbers/strings are for developers to see which changes happened in between points in the graph.</p>
   </li>
   <li>
    <p>What's ARM?</p>
    <p>ARM is the CPU present in many embedded devices, like smartphones. We're interested in this for mobile Firefox and Firefox OS.</p>
   </li>
   <li>
    <p>Is this open source?</p>
    <p>Fo' sho', <a href="https://github.com/haytjes/arewefastyet">https://github.com/haytjes/arewefastyet</a></p>
   </li>
   <li>
    <p>Suggestions?</p>
    <p><a href="mailto:Hannes Verschore <hverschore@mozilla.com>">e-mail</a></p>
  </ul>
 </div>
 <br>
</body>
</html>
